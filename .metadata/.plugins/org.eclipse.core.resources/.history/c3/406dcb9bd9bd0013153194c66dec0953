package com.iaraby.utility;

import java.io.ByteArrayOutputStream;
import java.io.InputStream;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.params.BasicHttpParams;
import org.apache.http.params.HttpConnectionParams;
import org.apache.http.params.HttpParams;

/*{This application to help developers create apps faster by collecting
 * the most used methods for android apps in one place, all you
 * have is to call the method you need and receive the results}
 Copyright (C) {2014} {Ahmad Sameer AlBarqawi} {iAraby}

 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 2 of the License, or
 (at your option) any later version.

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License along
 with this program; if not, write to the Free Software Foundation, Inc.,
 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

 For contact you can reach me on twitter: @Barqawi88
 */
/**
 * Basic connection layer methods that is similar when make any Http connection,
 * no need to re write it again, just use it from the methods her
 */
public class HttpUtility {

	/**
	 * Create basic Http params with received timeout
	 * This called when create new instance from DefaultHttpClient to set
	 * timeout for it
	 * 
	 * @param timeOut in milliseconds
	 * @return HttpParams
	 */
	public static HttpParams getHttpParams(int timeOut) {
		HttpParams httpParameters = new BasicHttpParams();
		httpParameters = new BasicHttpParams();

		int timeoutConnection = timeOut;
		HttpConnectionParams.setConnectionTimeout(httpParameters,
				timeoutConnection);

		int timeoutSocket = timeOut;
		HttpConnectionParams.setSoTimeout(httpParameters, timeoutSocket);

		return httpParameters;

	} //method: create basic HttpParams

	/**
	 * Read the Http response bytes and return the String value
	 * String value could be row data or josn or xml data 
	 * 
	 * @param HttpResponse
	 * @return String value 
	 * @throws IllegalStateException
	 * @throws IOException
	 */
	public static String readHttpResponse(HttpResponse response) throws IllegalStateException, IOException {
		HttpEntity entity = response.getEntity();
		InputStream inputStream = entity.getContent();

		ByteArrayOutputStream content = new ByteArrayOutputStream();

		// Read response into a buffered stream
		int readBytes = 0;
		byte[] sBuffer = new byte[512];
		while ((readBytes = inputStream.read(sBuffer)) != -1) {
			content.write(sBuffer, 0, readBytes);
		}
		
		//close connection
		inputStream.close();
		
		// Return result from buffered stream
		return(new String(content.toByteArray()));

	}
} // class: HttpUtility
