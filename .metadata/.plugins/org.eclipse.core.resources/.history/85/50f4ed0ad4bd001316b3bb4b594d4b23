package com.iaraby.utility;

import java.util.List;

import android.app.Activity;
import android.app.ActivityManager;
import android.app.ActivityManager.RunningAppProcessInfo;
import android.content.Context;
import android.content.Intent;
import android.content.pm.ActivityInfo;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.widget.Toast;

/*{This application to help developers create apps faster by collecting
 * the most used methods for android apps in one place, all you
 * have is to call the method you need and receive the results}
 Copyright (C) {2014} {Ahmad Sameer AlBarqawi} {iAraby}

 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 2 of the License, or
 (at your option) any later version.

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License along
 with this program; if not, write to the Free Software Foundation, Inc.,
 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

 For contact you can reach me on twitter: @Barqawi88
 */
/**
 * General utilities that collect common methods used in most apps to save time
 * on developers
 */
public class Utility {

	/**
	 * Check if Internet available even WIFI network or mobile data network
	 * 
	 * @param context
	 * @return true if network available, false otherwise
	 */
	public static boolean isNetworkAvailable(Context context) {
		boolean haveConnectedWifi = false;
		boolean haveConnectedMobile = false;

		ConnectivityManager cm = (ConnectivityManager) context
				.getSystemService(Context.CONNECTIVITY_SERVICE);
		NetworkInfo[] infoArray = cm.getAllNetworkInfo();
		for (NetworkInfo info : infoArray) {
			if (info.getTypeName().equalsIgnoreCase("WIFI")
					&& info.isConnected())
				haveConnectedWifi = true;
			if (info.getTypeName().equalsIgnoreCase("MOBILE")
					&& info.isConnected())
				haveConnectedMobile = true;
		}
		return haveConnectedWifi || haveConnectedMobile;
	} // check internet connection

	/**
	 * check if screen orientation is portrait
	 * 
	 * @param screenOrientation
	 * @return true if orientation portrait, false otherwise
	 */
	public static boolean isPortrait(int screenOrientation) {
		if (screenOrientation == ActivityInfo.SCREEN_ORIENTATION_PORTRAIT) {
			return true;
		} else {
			return false;
		} // check orientation
	} // method: check if portrait

	/**
	 * check if screen orientation is landscape
	 * 
	 * @param screenOrientation
	 * @return true if orientation landscape, false otherwise
	 */
	public static boolean isLandscape(int screenOrientation) {
		if (screenOrientation == ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE) {
			return true;
		} else {
			return false;
		} // check orientation
	} // method: check if portrait

	/**
	 * show short toast message for the user
	 * 
	 * @param Context
	 * @param String
	 *            message
	 */
	public static void showToastMessage(Context context, String msg) {
		if (msg == null) msg = "";
		
		Toast.makeText(context, msg, Toast.LENGTH_SHORT).show();
	} // method: show message

	/**
	 * check if the received String is numbers only
	 * 
	 * @param String
	 *            value
	 * @return true is the String is numbers only, false otherwise
	 */
	public static boolean isNumber(String value) {
		try {
			Integer.parseInt(value);
		} catch (NumberFormatException ex) {
			return false;
		}
		return true;
	} // method: check if string number or not

	/**
	 * Call share intent to share data with other apps like Faebook, Twitter,
	 * etc If you don't want to share link send empty String "" or null Don't
	 * send null in message or subject field
	 * 
	 * @param String
	 *            subject
	 * @param String
	 *            message
	 * @param String
	 *            link
	 * @param Activity
	 *            activity
	 */
	public static void share(String subject, String message, String link,
			Activity activity) {

		if (link == null || link.length() == 0) {
			link = "";
		} else {
			link = "\n" + link;
		}

		Intent sharingIntent = new Intent(Intent.ACTION_SEND);

		sharingIntent.setType("text/plain");
		sharingIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, subject);
		sharingIntent.putExtra(android.content.Intent.EXTRA_TEXT, message
				+ link);
		activity.startActivity(Intent.createChooser(sharingIntent, "Share"));
	}

	/**
	 * Check if the app is visible on foreground to make sure it is not in sleep or
	 * termination state. This method useful after come from long thread and
	 * want to check if the user still using the app now
	 * 
	 * @param context
	 * @return true if the app in foreground, false otherwise
	 */
	public static boolean isAppOnForeground(Context context) {
		ActivityManager activityManager = (ActivityManager) context
				.getSystemService(Context.ACTIVITY_SERVICE);
		List<RunningAppProcessInfo> appProcesses = activityManager
				.getRunningAppProcesses();
		if (appProcesses != null) {
		
			final String packageName = context.getPackageName();
			for (RunningAppProcessInfo appProcess : appProcesses) {
				if (appProcess.importance == RunningAppProcessInfo.IMPORTANCE_FOREGROUND
						&& appProcess.processName.equals(packageName)) {
					return true;
				}
			} //loop on all active processes
		} //make sure app process list not null
		return false;
	}

} // class: Utility
